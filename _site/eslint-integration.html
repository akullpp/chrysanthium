<!doctype html>
<html lang="en">
  <head>
    <title>ESLint Integration || Chrysanthium</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="akullpp" />
    <meta name="description" content="About software engineering" />
    <meta name="email" content="akullpp@gmail.com" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:creator" content="" />
    <meta name="twitter:title" content="ESLint Integration" />
    <meta name="twitter:image" content="https://chrysanthium.com/logo.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5" />
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/post.css">
    <link rel="stylesheet" href="/css/tomorrow.css">
  </head>

  <body>
    <header class="navigation">
      <ul>
        <li>
          <a href="/">Blog</a>
        </li>

        <li>
          <a href="/about">About</a>
        </li>
      </ul>
    </header>

    <h1>ESLint Integration</h1>
    
      <h6>2015/09</h6>
    

    <p><a href="http://eslint.org/">ESLint</a> is a JavaScript linter much more capable than JSHint in terms of customizability. This post will give you detailed instructions on how to integrate it in a multi-module project environment independent of its size. The approach presented is itself modular and creates a ESLint environment which is adaptable.</p>
<p>ESLint is to be preferred if programmatic enforcement with <a href="http://jscs.info/">JSCS</a> is out of the question. It strength stems from the usage of Espree an JavaScript parser that produces an <a href="http://felix-kling.de/esprima_ast_explorer/">Abstract Syntax Tree</a>. The exposition of the AST allows for creating own rules. Furthermore it provides a great documentation, built-in features and testing framework.</p>
<h2>Setup</h2>
<p>You want to create a plugin which governs your rules, therefore you will need to create a node module that will be added in each dependent's <code>package.json</code>. Please find a ready-to-use skeleton implementation <a href="https://github.com/akullpp/eslint-plugin-skeleton">here</a>.</p>
<blockquote>
<p>Note that the name of the folder and plugin itself must start with <code>eslint-plugin-</code></p>
</blockquote>
<h2>Structure</h2>
<p>Let us analyze the minimal structure of the plugin module:</p>
<pre><code>config/
  mixins/
  eslintrc.base
rules/
test/
index.js
package.json
</code></pre>
<p>The main configuration - with your rules initialized to a sensible default - is located in <code>config/eslintrc.base</code>. This file is also the <code>&quot;root&quot;: true</code> of our environment. The most important adaption is:</p>
<pre class="language-json"><code class="language-json"><span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">"skeleton"</span>
<span class="token punctuation">}</span></code></pre>
<p>which allows ESlint to recognize the folder <code>node_modules/eslint-plugin-skeleton/</code> as plugin once installed with npm.</p>
<blockquote>
<p>ESLint configuration files are YAML, a superset of JSON, which allow comments</p>
</blockquote>
<h2>Mixins</h2>
<p>It is common to have different environments in your application, e.g. in Angular you want different linting processes for your source folder and test folder. Probably you'll even want to distinguish between your tests based on whether they are unit, API or E2E tests. However, all of them can share a common ground and specify their individual needs.</p>
<blockquote>
<p>ESLint uses a cascading hierarchy, the proximate <code>.eslintrc</code> will have priority</p>
</blockquote>
<p>This is the case for <code>config/mixins</code>. The base configuration gets extended by a mixin for a particular environment:</p>
<ul>
<li>Source environment <code>config/mixin/browser</code>:</li>
</ul>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"env"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"browser"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"function"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"no-console"</span><span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>Test environment <code>config/mixin/test</code>:</li>
</ul>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"env"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"mocha"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"skeleton/leftover-only"</span><span class="token operator">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Note the prefix of the custom rule is the same as the plugin name.</p>
<p><code>leftover-only</code> is an example rule which detects <code>.only</code></p>
<ul>
<li>Unit test environment <code>config/mixin/unit</code>:</li>
</ul>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./browser"</span><span class="token punctuation">,</span> <span class="token string">"./test"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"globals"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"inject"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"sinon"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2>Custom Rules</h2>
<p>Custom rules go to <code>rules</code> and their respective tests to <code>test</code>. They have to be exported inside the <code>index.js</code>:</p>
<pre class="language-js"><code class="language-js"><span class="token string">'use strict'</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'leftover-only'</span><span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./rules/leftover-only'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre>
<h2>Integration</h2>
<p>The dependent modules or applications will need to add following dependencies to their <code>package.json</code>:</p>
<pre class="language-json"><code class="language-json"><span class="token property">"eslint"</span><span class="token operator">:</span> <span class="token string">"^1.1.0"</span><span class="token punctuation">,</span>
<span class="token property">"eslint-plugin-skeleton"</span><span class="token operator">:</span> <span class="token string">"^1.0.0"</span></code></pre>
<blockquote>
<p>You'll need a private registry or you have to use git urls</p>
</blockquote>
<p>Let's construct a typical Angular application structure enriched by ESLint:</p>
<pre><code>app/
  bower_components/
  .eslintrc
node_modules/
test/
  e2e/
    .eslintrc
  api/
    .eslintrc
  unit/
    .eslintrc
.eslintignore
.eslintrc
</code></pre>
<p>The <code>.eslintignore</code> is similar to a <code>.gitignore</code> and should ignore your <code>app/bower_components</code> and your <code>dist</code>.</p>
<p>The base <code>.eslintrc</code> will extend the base configuration from the plugin and function as root:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token string">"./node_modules/eslint-plugin-skeleton/config/eslintrc.base"</span>
<span class="token punctuation">}</span></code></pre>
<p>The specific configurations extend their mixin. Examples:</p>
<p><code>app/.eslintrc</code>:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token string">"../node_modules/eslint-plugin-skeleton/config/mixins/browser"</span>
<span class="token punctuation">}</span></code></pre>
<p><code>app/test/unit/.eslintrc</code>:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token string">"../node_modules/eslint-plugin-skeleton/config/mixins/unit"</span>
<span class="token punctuation">}</span></code></pre>
<p>and so on.</p>
<p>If you then run <code>npm i</code> it will install the plugin and it will be available. Changes to your linting can be made at a central location, your build tool isn't a special case and it works flawless with editor plugins.</p>
<blockquote>
<p>Global ESLint doesn't recognize local plugins. Always install ESLint and the plugin locally. Also you can't link your Gulp module with the lint task.</p>
</blockquote>


    <footer class="navigation">
      <ul>
        <li>
          <a href="/privacy">Privacy</a>
        </li>

        <li>
          <a href="/legal">Legal</a>
        </li>
      </ul>
    </footer>
  </body>
</html>
